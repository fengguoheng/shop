"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[300],{8300:function(e,a,s){s.r(a),s.d(a,{default:function(){return h}});s(4114);var l=s(641),t=s(953),o=s(33),r=s(810),n=s(4335),i=s(2169);const u=(0,r.nY)("login",{state:()=>({form:{username:"",password:""},message:"",loginError:!1,email:"",isLoggedIn:!1}),actions:{async sqlLogin(){try{const e=await n.A.post(`${i.A}/api/sqlLogin`,{username:this.form.username,password:this.form.password},{withCredentials:!0});return"SQL 数据库登录成功"===e.data.message?(this.loginError=!1,this.message=e.data.message,this.email=e.data.email,this.isLoggedIn=e.data.b,console.log(this.isLoggedIn),localStorage.setItem("isLoggedIn",this.isLoggedIn),localStorage.setItem("email",this.email),localStorage.setItem("username",e.data.username),localStorage.setItem("id",e.data.id),!0):(this.loginError=!0,this.message=e.data.message,!1)}catch(e){return this.message="SQL 登录失败",!1}}}});var d=s(5220);const m={class:"login-container"};var g={__name:"UserLogin",emits:["login-success"],setup(e,{emit:a}){const s=u(),r=a,n=(0,t.KR)(null),g=(0,d.rd)(),c=async()=>{const e=await s.sqlLogin();e&&(r("login-success"),g.push("/home"))},f=()=>{window.location.href=`${i.A}/auth/github`},h=()=>{g.push("/register")},p=()=>{g.push("/home")};return(e,a)=>{const r=(0,l.g2)("el-input"),i=(0,l.g2)("el-form-item"),u=(0,l.g2)("el-button"),d=(0,l.g2)("el-form"),g=(0,l.g2)("el-card");return(0,l.uX)(),(0,l.CE)("div",m,[(0,l.bF)(g,{class:"login-card"},{header:(0,l.k6)((()=>a[2]||(a[2]=[(0,l.Lk)("h2",null,"登录",-1)]))),default:(0,l.k6)((()=>[(0,l.bF)(d,{model:(0,t.R1)(s).form,ref_key:"formRef",ref:n},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{modelValue:(0,t.R1)(s).form.username,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,t.R1)(s).form.username=e),placeholder:"用户名",class:(0,o.C4)({"error-input":(0,t.R1)(s).loginError})},null,8,["modelValue","class"])])),_:1}),(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{modelValue:(0,t.R1)(s).form.password,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,t.R1)(s).form.password=e),placeholder:"密码",type:"password"},null,8,["modelValue"])])),_:1}),(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{type:"primary",onClick:c},{default:(0,l.k6)((()=>a[3]||(a[3]=[(0,l.eW)("登录")]))),_:1}),(0,l.bF)(u,{onClick:h},{default:(0,l.k6)((()=>a[4]||(a[4]=[(0,l.eW)("现在去注册")]))),_:1}),(0,l.bF)(u,{id:"githubLoginBtn",onClick:f},{default:(0,l.k6)((()=>a[5]||(a[5]=[(0,l.eW)(" 使用 GitHub 登录 ")]))),_:1}),(0,l.bF)(u,{onClick:p},{default:(0,l.k6)((()=>a[6]||(a[6]=[(0,l.eW)("游客")]))),_:1})])),_:1})])),_:1},8,["model"]),(0,l.Lk)("p",null,(0,o.v_)((0,t.R1)(s).message),1)])),_:1}),a[7]||(a[7]=(0,l.Lk)("img",{src:"background.jpg",alt:"背景图",class:"bg-image"},null,-1))])}}},c=s(6262);const f=(0,c.A)(g,[["__scopeId","data-v-15f2c40d"]]);var h=f}}]);
//# sourceMappingURL=300.9d831da2.js.map