{"version":3,"file":"js/738.a7f816b8.js","mappings":"yGAAA,IAAIA,EAIAA,EAAS,YAEb,K,+LCoBA,MAAMC,GAAcC,EAAAA,EAAAA,IAAI,CACpBC,MAAO,GACPC,QAAS,KAIPC,GAAQH,EAAAA,EAAAA,IAAI,CACdC,MAAO,CAAC,CAAEG,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACvDJ,QAAS,CAAC,CAAEE,UAAU,EAAMC,QAAS,UAAWC,QAAS,WAIvDC,GAAUP,EAAAA,EAAAA,IAAI,MACdQ,GAAWR,EAAAA,EAAAA,IAAI,IACfS,GAAWT,EAAAA,EAAAA,IAAI,CAAC,GAChBU,GAAaV,EAAAA,EAAAA,KAAI,GAGjBW,EAAgBC,UACbL,EAAQM,OACbN,EAAQM,MAAMC,UAASF,UACnB,GAAIG,EACA,IAEI,MAAMC,QAAiBC,EAAAA,EAAMC,KAAK,GAAGpB,EAAAA,qBAA0BW,EAASI,MAAML,WAAYT,EAAYc,OAC9E,MAApBG,EAASG,QACTC,EAAAA,GAAUC,QAAQ,UAClBtB,EAAYc,MAAQ,CAAEZ,MAAO,GAAIC,QAAS,KAE1CkB,EAAAA,GAAUE,MAAM,eAExB,CAAE,MAAOA,GACLC,QAAQD,MAAM,QAASA,GACvBF,EAAAA,GAAUE,MAAM,eACpB,MAEAF,EAAAA,GAAUE,MAAM,YACpB,GACF,EAIAE,EAASA,KACXzB,EAAYc,MAAQ,CAAEZ,MAAO,GAAIC,QAAS,IAC1CuB,QAAQC,MAAM,E,OAElBC,EAAAA,EAAAA,KAAUf,UACN,IACIJ,EAASK,MAAQe,aAAaC,QAAQ,YAEtC,MAAMb,QAAiBC,EAAAA,EAAMa,IAAI,GAAGhC,EAAAA,UAAgB,CAChDiC,iBAAiB,IAEjBf,EAASgB,KAAKtB,aACdA,EAAWG,OAAQ,EACnBJ,EAASI,MAAQG,EAASgB,KAElC,CAAE,MAAOV,GACLC,QAAQD,MAAM,YAAaA,EAC/B,K,ygCC/EJ,MAAMW,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://client/./src/config.js","webpack://client/./src/views/撰写文章.vue","webpack://client/./src/views/撰写文章.vue?f423"],"sourcesContent":["let apiUrl;\r\nif (process.env.NODE_ENV === 'development') {\r\n    apiUrl = 'https://tender-secure-bluegill.ngrok-free.app'; // 开发环境ngrok地址\r\n} else {\r\n    apiUrl = '生产环境API地址'; // 这里需替换为实际生产环境API地址，若没变化还是ngrok地址\r\n}\r\nexport default apiUrl;","<template>\r\n    <div class=\"article-write-container\">\r\n        <el-form ref=\"formRef\" :model=\"articleForm\" :rules=\"rules\" label-width=\"100px\" class=\"form-container\">\r\n            <el-form-item label=\"文章标题\" prop=\"title\">\r\n                <el-input v-model=\"articleForm.title\" placeholder=\"请输入文章标题\"></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"文章内容\" prop=\"content\">\r\n                <el-input v-model=\"articleForm.content\" type=\"textarea\" :rows=\"5\" placeholder=\"请输入文章内容\"></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item>\r\n                <el-button type=\"primary\" @click=\"submitArticle\">提交文章</el-button>\r\n                <el-button style=\"margin-left: 10px\" @click=\"cancel\">取消</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport { ElMessage } from 'element-plus';\r\nimport axios from 'axios';\r\nimport apiUrl from '../config.js';\r\n\r\n// 表单数据\r\nconst articleForm = ref({\r\n    title: '',\r\n    content: ''\r\n});\r\n\r\n// 表单验证规则\r\nconst rules = ref({\r\n    title: [{ required: true, message: '请输入文章标题', trigger: 'blur' }],\r\n    content: [{ required: true, message: '请输入文章内容', trigger: 'blur' }]\r\n});\r\n\r\n// 模板引用\r\nconst formRef = ref(null);\r\nconst username = ref('');\r\nconst userInfo = ref({});\r\nconst isLoggedIn = ref(false);\r\n\r\n// 提交文章方法\r\nconst submitArticle = async () => {\r\n    if (!formRef.value) return;\r\n    formRef.value.validate(async (valid) => {\r\n        if (valid) {\r\n            try {\r\n                // 替换为实际的接口地址\r\n                const response = await axios.post(`${apiUrl}/api/submitBlogs/${userInfo.value.username}`, articleForm.value);\r\n                if (response.status === 200) {\r\n                    ElMessage.success('文章提交成功');\r\n                    articleForm.value = { title: '', content: '' };\r\n                } else {\r\n                    ElMessage.error('文章提交失败，请稍后重试');\r\n                }\r\n            } catch (error) {\r\n                console.error('请求出错:', error);\r\n                ElMessage.error('文章提交失败，请稍后重试');\r\n            }\r\n        } else {\r\n            ElMessage.error('请检查表单填写内容');\r\n        }\r\n    });\r\n};\r\n\r\n// 取消操作\r\nconst cancel = () => {\r\n    articleForm.value = { title: '', content: '' };\r\n    history.back();\r\n};\r\nonMounted(async () => {\r\n    try {\r\n        username.value = localStorage.getItem('username'); // 获取用户名并赋值给响应式变量\r\n\r\n        const response = await axios.get(`${apiUrl}/check`, {\r\n            withCredentials: true // 携带 cookie 信息\r\n        });\r\n        if (response.data.isLoggedIn) {\r\n            isLoggedIn.value = true;\r\n            userInfo.value = response.data;\r\n        }\r\n    } catch (error) {\r\n        console.error('验证登录状态出错:', error);\r\n    }\r\n\r\n\r\n\r\n\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.article-write-container {\r\n    padding: 20px;\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.form-container {\r\n    background: #ffffff;\r\n    padding: 20px;\r\n    border-radius: 8px;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n</style>","import script from \"./撰写文章.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./撰写文章.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./撰写文章.vue?vue&type=style&index=0&id=07ec9da2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-07ec9da2\"]])\n\nexport default __exports__"],"names":["apiUrl","articleForm","ref","title","content","rules","required","message","trigger","formRef","username","userInfo","isLoggedIn","submitArticle","async","value","validate","valid","response","axios","post","status","ElMessage","success","error","console","cancel","history","back","onMounted","localStorage","getItem","get","withCredentials","data","__exports__"],"sourceRoot":""}